package modelo;

import java.util.ArrayList;
//Datos de asientos = [Codigo asiento,precio asiento,clase(T-E-P),ubicacion(V-C-P),estado(R-D)]

public class Buscador {	
	private Double recargoUsuarioNoPago = 20.0;
	private ArrayList<Aerolinea> aerolineas;
	//lista de aerolineas para todo el buscador
	//recorrer todas las aerolineas y buscar los asientos disponibles de todas las aerolineas interfaz en comun
	public ArrayList<Asiento> busqueda(Usuario usuario,Busqueda busqueda) {
		ArrayList<Asiento> asientosDisp = new ArrayList<Asiento>();
		ArrayList<Aerolinea> aerolineas = new ArrayList<Aerolinea>();
		//pasarle solo busqueda
		//test de asientos disponibles con atributos nulos
		aerolineas.forEach(aerolinea -> asientosDisp.add(aerolinea.asientosDisponibles(busqueda)));
		asientosDisp.forEach(asiento -> asiento.actualizarPrecioTotal(usuario));
		busqueda.getFiltros().forEach(filtro -> filtro.aplicarFiltro());
		/*filtrarPorClase(asientosDisp,busqueda.getClase());
		filtrarPorUbicacion(asientosDisp,busqueda.getUbicacion());
		filtrarPorPrecio(asientosDisp, busqueda.getPrecioMin(), busqueda.getPrecioMax());*/
		if(!usuario.esVip()) {asientosDisp.removeIf(asiento -> esSuperOferta(asiento));}
		usuario.agregarBusqueda(busqueda);
		return asientosDisp;
	}
	//mover comprar y reservar a usuario	
	public void transferirReserva(String codigoAsiento) {
		aerolineas.forEach(aerolinea -> aerolinea.transferirReserva(codigoAsiento));
	}
		
	private boolean esSuperOferta(Asiento asiento) {
		return ((asiento.getClase().equals(TipoClaseAsiento.PRIMERA) && asiento.getPrecio()<8000)||(asiento.getClase().equals(TipoClaseAsiento.EJECUTIVA) && asiento.getPrecio()<4000));
	}
}
